\documentclass[color=usenames,dvipsnames]{beamer}\usepackage[]{graphicx}\usepackage[]{color}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0, 0, 0}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.69,0.494,0}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.749,0.012,0.012}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.514,0.506,0.514}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0,0.341,0.682}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.004,0.004,0.506}{#1}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
%\documentclass[color=usenames,dvipsnames,handout]{beamer}


\usepackage[roman]{../lectures}
%\usepackage[sans]{../lectures}


\hypersetup{pdfpagemode=UseNone,pdfstartview={FitV}}



\title{Lecture 2 -- Basic models of population Dynamics}
\author{Richard Chandler}
%\date{January 14, 2019}



% Load function to compile and open PDF


% Compile and open PDF







%<<knitr-setup,include=FALSE,purl=FALSE>>=
%##opts_chunk$set(comment=NA)
%@


%% New command for inline code that isn't to be evaluated
\definecolor{inlinecolor}{rgb}{0.878, 0.918, 0.933}
\newcommand{\inr}[1]{\colorbox{inlinecolor}{\texttt{#1}}}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

% This would affect all code boxes. Not a good idea.
% \setlength\fboxsep{0pt}



\begin{frame}[plain]
  \LARGE
%  \maketitle
  \centering
  {\huge Lecture 2 -- Basic models of population dynamics} \\
  {\color{default} \rule{\textwidth}{0.1pt}}
  \vfill
  \large
  WILD(FISH) 8390 \\
  Estimation of Fish and Wildlife Population Parameters \\
  \vfill
  \large
  Richard Chandler \\
  University of Georgia \\
\end{frame}




\section{BIDE model}%, exponential, logistic models}


\begin{frame}[plain]
  \frametitle{Today's Topics}
  \Large
  \only<1>{\tableofcontents}%[hideallsubsections]}
  \only<2 | handout:0>{\tableofcontents[currentsection]}%,hideallsubsections]}
\end{frame}



\begin{frame}
  \frametitle{BIDE model}
  Abundance at time $t$
  \[
%    N_t = N_{t-1} + B_{t-1} + I_{t-1} - D_{t-1} - E_{t-1}
    N_{t+1} = N_t + {\color{red}B}_t + {\color{red}I}_t - {\color{red}D}_t - {\color{red}E}_t
  \]
  \textcolor{red}{B}=Births, {\color{red}I}=Immigrations,
  {\color{red}D}=Deaths, {\color{red}E}=Emigrations \\
  \pause
  \vfill
  Geometric growth is a simplification of \textcolor{red}{BIDE}. \\
  \pause
  \vfill
  Exponential growth is a continuous time version of geometric growth.
\end{frame}


\begin{frame}
  \frametitle{From {\color{red} BIDE} To Geometric Growth}
  {\bf \large Ignore immigration and emigration}
  \[
  N_{t+1} = N_t + B_t - D_t
  \]
  \vspace{0.5cm}
  \begin{tabular}{ccl}
    $N_t$ & = & Abundance at time $t$ \\
    {\color{red} $B$}    & = & Births       \\
    {\color{red} $D$}    & = & Deaths       \\
  \end{tabular}
\end{frame}


\begin{frame}
  \frametitle{From {\color{red} BIDE} To Geometric Growth}
    \textbf{Step 1:} Divide both sides by $N_{t}$
      \[
        \frac{N_{t+1}}{N_{t}} \quad = \quad 1 + \frac{B_t}{N_{t}} - \frac{D_t}{N_{t}}
      \]
   \pause
    \textbf{Step 2:} Write in terms of \textit{per capita} birth and death \textit{rates}
      \[
        \frac{N_{t+1}}{N_{t}} \quad  = \quad 1 + b - d \quad = \quad 1 + r \quad = \quad \lambda
      \]
    \pause
    \textbf{Step 3:} Geometric growth \par
    \begin{center}
      $N_{t+1} = N_t + N_tr$
    \end{center}
\end{frame}






\section{Exponential and logistic growth}


\begin{frame}
  \frametitle{Geometric growth -- two formulations}
  Option 1 (arbitrary time step)
  \[
    N_t = N_0(1+r)^t
  \]
  \pause
  \vfill
  Option 2 (recursive, one time step at a time)
  \[
    N_t = N_{t-1} + N_{t-1}r
  \]
\end{frame}




\begin{frame}[fragile]
  \frametitle{Geometric growth in \R~-- Option 1}
\begin{knitrout}\scriptsize
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{time} \hlkwb{<-} \hlnum{0}\hlopt{:}\hlnum{100}
\hlstd{T} \hlkwb{<-} \hlkwd{length}\hlstd{(time)}     \hlcom{## number of time points}
\hlstd{r} \hlkwb{<-} \hlnum{0.01}             \hlcom{## growth rate}
\hlstd{N1} \hlkwb{<-} \hlnum{10}\hlopt{*}\hlstd{(}\hlnum{1}\hlopt{+}\hlstd{r)}\hlopt{^}\hlstd{time}   \hlcom{## abundance at time t. N(0)=10}
\hlkwd{plot}\hlstd{(time, N1,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Abundance"}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{"l"}\hlstd{,} \hlkwc{cex.lab}\hlstd{=}\hlnum{1.5}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.9\textwidth]{figure/geo1-1} 

}



\end{knitrout}
\end{frame}




\begin{frame}[fragile]
  \frametitle{Geometric growth in \R~-- Option 2}
\begin{knitrout}\tiny
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{N2} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{10}\hlstd{,} \hlkwd{c}\hlstd{(}\hlnum{NA}\hlstd{, T}\hlopt{-}\hlnum{1}\hlstd{))}  \hlcom{## initial abundance = 10}
\hlkwa{for}\hlstd{(t} \hlkwa{in} \hlnum{2}\hlopt{:}\hlstd{T) \{}
    \hlstd{N2[t]} \hlkwb{<-} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]} \hlopt{+} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]}\hlopt{*}\hlstd{r}
\hlstd{\}}
\hlkwd{plot}\hlstd{(time, N1,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Abundance"}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{"l"}\hlstd{,} \hlkwc{cex.lab}\hlstd{=}\hlnum{1.5}\hlstd{)}
\hlkwd{lines}\hlstd{(time, N2,} \hlkwc{col}\hlstd{=}\hlkwd{rgb}\hlstd{(}\hlnum{0}\hlstd{,}\hlnum{0}\hlstd{,}\hlnum{1}\hlstd{,}\hlnum{0.5}\hlstd{),} \hlkwc{lwd}\hlstd{=}\hlnum{10}\hlstd{)}
\hlkwd{legend}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{27}\hlstd{,} \hlkwd{c}\hlstd{(}\hlstr{"Geometric growth - option 1"}\hlstd{,} \hlstr{"Geometric growth - option 2"}\hlstd{),}
       \hlkwc{lwd}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{10}\hlstd{),} \hlkwc{col}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlkwd{rgb}\hlstd{(}\hlnum{0}\hlstd{,}\hlnum{0}\hlstd{,}\hlnum{1}\hlstd{,}\hlnum{0.5}\hlstd{)))}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.9\textwidth]{figure/geo2-1} 

}



\end{knitrout}
\end{frame}


\begin{frame}
  \frametitle{Geometric growth with stochastic rate}
  Normally-distributed growth rate
  \[
    N_t = N_{t-1} + N_{t-1}r_{t-1}
  \]
  \[
    r_t \sim \mathrm{Norm}(\bar{r}, \sigma^2)
  \]
\end{frame}



\begin{frame}[fragile]
  \frametitle{Geometric growth with stochastic rate}
\begin{knitrout}\tiny
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{N3} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{10}\hlstd{,} \hlkwd{c}\hlstd{(}\hlnum{NA}\hlstd{, T}\hlopt{-}\hlnum{1}\hlstd{))}  \hlcom{## initial abundance = 10}
\hlstd{r} \hlkwb{<-} \hlkwd{rep}\hlstd{(}\hlnum{NA}\hlstd{, T}\hlopt{-}\hlnum{1}\hlstd{)}
\hlkwa{for}\hlstd{(t} \hlkwa{in} \hlnum{2}\hlopt{:}\hlstd{T) \{}
    \hlstd{r[t}\hlopt{-}\hlnum{1}\hlstd{]} \hlkwb{<-} \hlkwd{rnorm}\hlstd{(}\hlkwc{n}\hlstd{=}\hlnum{1}\hlstd{,} \hlkwc{mean}\hlstd{=}\hlnum{0.01}\hlstd{,} \hlkwc{sd}\hlstd{=}\hlnum{0.2}\hlstd{)}
    \hlstd{N3[t]} \hlkwb{<-} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]} \hlopt{+} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]}\hlopt{*}\hlstd{r[t}\hlopt{-}\hlnum{1}\hlstd{]}
\hlstd{\}}
\hlkwd{plot}\hlstd{(time, N3,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Abundance"}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{"l"}\hlstd{,} \hlkwc{cex.lab}\hlstd{=}\hlnum{1.5}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.9\textwidth]{figure/geo3-1} 

}



\end{knitrout}
\end{frame}



\begin{frame}
  \frametitle{In-class exercise}
  \centering
  \begin{enumerate}
    \item<1-> Assess the impacts of changing $\bar{r}$ and $\sigma$ in the
      geometric growth model using the settings in the previous examples.
    \item[]
    \item<2-> Simulate abundance using the model $N_t = N_{t-1} +
      N_{t-1}r + X_{t-1}$ with $X_t \sim \mathrm{Norm}(0, 10)$ and
      $r=0.1$. Let the other settings be the same as before.
\end{enumerate}
\end{frame}




\begin{frame}
  \frametitle{Exponential growth}
  Abundance at time $t$
  \[
    N(t) = N(0)e^{rt}
  \]
  \pause
%  \vfill
  Notice how similar this is to the first version of geometric growth
  from earlier $N_t = N_0(1+r)^t$. \\
  \pause
  \vfill
  It is simply the continuous-time version of geometric growth, with
  instantaneous rate of change:
  \[
    \frac{dN}{dt} = rN
  \]
\end{frame}







%\section{Logistic growth}

\begin{frame}
  \frametitle{Logistic growth}
  Continuous-time version has instantaneous growth rate
  \[
    \frac{dN}{dt} = rN\left(1-\frac{N}{K}\right)
  \]
  \pause
  \vfill
  Discrete-time model (difference equation) looks like this:
  \[
    N_t = N_{t-1} + rN_{t-1}\left(1-\frac{N_{t-1}}{K}\right)
  \]
  \pause
  \vfill
  Discrete-time model can result in over-compensation and chaos
\end{frame}




\begin{frame}[fragile]
  \frametitle{What happens when we change $r$?}





\begin{center}
  \only<1|handout:0>{\includegraphics[width=\textwidth]{figure/Nl-1}}
  \only<2|handout:0>{\includegraphics[width=\textwidth]{figure/Nl2-1}}
  \only<3|handout:0>{\includegraphics[width=\textwidth]{figure/Nl3-1}}
  \only<4>{\includegraphics[width=\textwidth]{figure/Nl4-1}}
\end{center}
\end{frame}





\section{Matrix models}

\begin{frame}
  \frametitle{Age-structured population model}

\end{frame}


\begin{frame}
  \frametitle{Size-structured population model}

\end{frame}


\section{Metapopulation models}

\begin{frame}
  \frametitle{\large Abundance-based metapopulation population model}
  Can be formulated as matrix model
\end{frame}


\begin{frame}
  \frametitle{\large Occupancy-based metapopulation population model}

\end{frame}



%\section{Stochasticity}







    
    





\end{document}
