\documentclass[color=usenames,dvipsnames]{beamer}\usepackage[]{graphicx}\usepackage[]{color}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0, 0, 0}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.69,0.494,0}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.749,0.012,0.012}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.514,0.506,0.514}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0,0.341,0.682}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0,0,0}{\textbf{#1}}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.004,0.004,0.506}{#1}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
%\documentclass[color=usenames,dvipsnames,handout]{beamer}


\usepackage[roman]{../lectures}
%\usepackage[sans]{../lectures}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,snakes,backgrounds}


\hypersetup{pdfpagemode=UseNone,pdfstartview={FitV}}



\title{Lecture 2 -- Basic models of population Dynamics}
\author{Richard Chandler}
%\date{January 14, 2019}



% Load function to compile and open PDF


% Compile and open PDF







%<<knitr-setup,include=FALSE,purl=FALSE>>=
%##opts_chunk$set(comment=NA)
%@


%% New command for inline code that isn't to be evaluated
\definecolor{inlinecolor}{rgb}{0.878, 0.918, 0.933}
\newcommand{\inr}[1]{\colorbox{inlinecolor}{\texttt{#1}}}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

% This would affect all code boxes. Not a good idea.
% \setlength\fboxsep{0pt}



\begin{frame}[plain]
  \LARGE
%  \maketitle
  \centering
  {\huge Lecture 2 -- Basic models of population dynamics} \\
  {\color{default} \rule{\textwidth}{0.1pt}}
  \vfill
  \large
  WILD(FISH) 8390 \\
  Estimation of Fish and Wildlife Population Parameters \\
  \vfill
  \large
  Richard Chandler \\
  University of Georgia \\
\end{frame}




\section{BIDE model}%, exponential, logistic models}


\begin{frame}[plain]
  \frametitle{Today's Topics}
  \Large
  \only<1>{\tableofcontents}%[hideallsubsections]}
  \only<2 | handout:0>{\tableofcontents[currentsection]}%,hideallsubsections]}
\end{frame}



\begin{frame}
  \frametitle{BIDE model}
  Abundance at time $t$
  \[
%    N_t = N_{t-1} + B_{t-1} + I_{t-1} - D_{t-1} - E_{t-1}
    N_{t+1} = N_t + {\color{red}B}_t + {\color{red}I}_t - {\color{red}D}_t - {\color{red}E}_t
  \]
  \textcolor{red}{B}=Births, {\color{red}I}=Immigrations,
  {\color{red}D}=Deaths, {\color{red}E}=Emigrations \\
  \pause
  \vfill
  Geometric growth is a simplification of \textcolor{red}{BIDE}. \\
  \pause
  \vfill
  Exponential growth is a continuous time version of geometric growth.
\end{frame}


\begin{frame}
  \frametitle{From {\color{red} BIDE} To Geometric Growth}
  {\bf \large Ignore immigration and emigration}
  \[
  N_{t+1} = N_t + B_t - D_t
  \]
  \vspace{0.5cm}
  \begin{tabular}{ccl}
    $N_t$ & = & Abundance at time $t$ \\
    {\color{red} $B$}    & = & Births       \\
    {\color{red} $D$}    & = & Deaths       \\
  \end{tabular}
\end{frame}


\begin{frame}
  \frametitle{From {\color{red} BIDE} To Geometric Growth}
    \textbf{Step 1:} Divide both sides by $N_{t}$
      \[
        \frac{N_{t+1}}{N_{t}} \quad = \quad 1 + \frac{B_t}{N_{t}} - \frac{D_t}{N_{t}}
      \]
   \pause
    \textbf{Step 2:} Write in terms of \textit{per capita} birth and death \textit{rates}
      \[
        \frac{N_{t+1}}{N_{t}} \quad  = \quad 1 + b - d \quad = \quad 1 + r \quad = \quad \lambda
      \]
    \pause
    \textbf{Step 3:} Geometric growth \par
    \begin{center}
      $N_{t+1} = N_t + N_tr$
    \end{center}
\end{frame}






\section{Exponential and logistic growth}


\begin{frame}
  \frametitle{Geometric growth -- two formulations}
  Option 1 (arbitrary time step)
  \[
    N_t = N_0(1+r)^t
  \]
  \pause
  \vfill
  Option 2 (recursive, one step at a time)
  \[
    N_t = N_{t-1} + N_{t-1}r
  \]
\end{frame}




\begin{frame}[fragile]
  \frametitle{Geometric growth in \R~-- Option 1}
\begin{knitrout}\scriptsize
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{time} \hlkwb{<-} \hlnum{0}\hlopt{:}\hlnum{100}
\hlstd{T} \hlkwb{<-} \hlkwd{length}\hlstd{(time)}     \hlcom{## number of time points}
\hlstd{r} \hlkwb{<-} \hlnum{0.01}             \hlcom{## growth rate}
\hlstd{N1} \hlkwb{<-} \hlnum{10}\hlopt{*}\hlstd{(}\hlnum{1}\hlopt{+}\hlstd{r)}\hlopt{^}\hlstd{time}   \hlcom{## abundance at time t. N(0)=10}
\hlkwd{plot}\hlstd{(time, N1,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Abundance"}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{"l"}\hlstd{,} \hlkwc{cex.lab}\hlstd{=}\hlnum{1.5}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.9\textwidth]{figure/geo1-1} 

}



\end{knitrout}
\end{frame}




\begin{frame}[fragile]
  \frametitle{Geometric growth in \R~-- Option 2}
\begin{knitrout}\tiny
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{N2} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{10}\hlstd{,} \hlkwd{c}\hlstd{(}\hlnum{NA}\hlstd{, T}\hlopt{-}\hlnum{1}\hlstd{))}  \hlcom{## initial abundance = 10}
\hlkwa{for}\hlstd{(t} \hlkwa{in} \hlnum{2}\hlopt{:}\hlstd{T) \{}
    \hlstd{N2[t]} \hlkwb{<-} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]} \hlopt{+} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]}\hlopt{*}\hlstd{r}
\hlstd{\}}
\hlkwd{plot}\hlstd{(time, N1,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Abundance"}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{"l"}\hlstd{,} \hlkwc{cex.lab}\hlstd{=}\hlnum{1.5}\hlstd{)}
\hlkwd{lines}\hlstd{(time, N2,} \hlkwc{col}\hlstd{=}\hlkwd{rgb}\hlstd{(}\hlnum{0}\hlstd{,}\hlnum{0}\hlstd{,}\hlnum{1}\hlstd{,}\hlnum{0.5}\hlstd{),} \hlkwc{lwd}\hlstd{=}\hlnum{10}\hlstd{)}
\hlkwd{legend}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{27}\hlstd{,} \hlkwd{c}\hlstd{(}\hlstr{"Geometric growth - option 1"}\hlstd{,} \hlstr{"Geometric growth - option 2"}\hlstd{),}
       \hlkwc{lwd}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{10}\hlstd{),} \hlkwc{col}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlkwd{rgb}\hlstd{(}\hlnum{0}\hlstd{,}\hlnum{0}\hlstd{,}\hlnum{1}\hlstd{,}\hlnum{0.5}\hlstd{)))}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.9\textwidth]{figure/geo2-1} 

}



\end{knitrout}
\end{frame}


\begin{frame}[fragile]
  \frametitle{Geometric growth with stochastic rate}
  Normally-distributed growth rate
  \[
    N_t = N_{t-1} + N_{t-1}r_{t-1}
  \]
  \[
    r_t \sim \mathrm{Norm}(\bar{r}, \sigma^2)
  \]
  \pause
\begin{knitrout}\small
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{N3} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{10}\hlstd{,} \hlkwd{c}\hlstd{(}\hlnum{NA}\hlstd{, T}\hlopt{-}\hlnum{1}\hlstd{))}  \hlcom{## initial abundance = 10}
\hlstd{r} \hlkwb{<-} \hlkwd{rep}\hlstd{(}\hlnum{NA}\hlstd{, T}\hlopt{-}\hlnum{1}\hlstd{)}
\hlstd{rbar} \hlkwb{<-} \hlnum{0.01}
\hlstd{sigma} \hlkwb{<-} \hlnum{0.2}
\hlkwa{for}\hlstd{(t} \hlkwa{in} \hlnum{2}\hlopt{:}\hlstd{T) \{}
    \hlstd{r[t}\hlopt{-}\hlnum{1}\hlstd{]} \hlkwb{<-} \hlkwd{rnorm}\hlstd{(}\hlkwc{n}\hlstd{=}\hlnum{1}\hlstd{,} \hlkwc{mean}\hlstd{=rbar,} \hlkwc{sd}\hlstd{=sigma)}
    \hlstd{N3[t]} \hlkwb{<-} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]} \hlopt{+} \hlstd{N2[t}\hlopt{-}\hlnum{1}\hlstd{]}\hlopt{*}\hlstd{r[t}\hlopt{-}\hlnum{1}\hlstd{]}
\hlstd{\}}
\end{alltt}
\end{kframe}
\end{knitrout}
\end{frame}



\begin{frame}[fragile]
  \frametitle{Geometric growth with stochastic rate}
\begin{knitrout}\scriptsize
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{plot}\hlstd{(time, N3,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Abundance"}\hlstd{,} \hlkwc{type}\hlstd{=}\hlstr{"l"}\hlstd{,} \hlkwc{cex.lab}\hlstd{=}\hlnum{1.5}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.99\textwidth]{figure/geo3-1} 

}



\end{knitrout}
\end{frame}



\begin{frame}
  \frametitle{In-class exercise}
  \centering
  \begin{enumerate}
    \item<1-> Assess the impacts of changing $\bar{r}$ and $\sigma$ in the
      geometric growth model using the settings in the previous examples.
    \item[]
    \item<2-> Simulate abundance using the model $N_t = N_{t-1} +
      N_{t-1}r + X_{t-1}$ with $X_t \sim \mathrm{Norm}(0, 10)$ and
      $r=0.1$. Let the other settings be the same as before.
  \end{enumerate}
\end{frame}




\begin{frame}
  \frametitle{Exponential growth}
  Abundance at time $t$
  \[
    N(t) = N(0)e^{rt}
  \]
  \pause
%  \vfill
  Notice how similar this is to the first version of geometric growth
  from earlier $N_t = N_0(1+r)^t$. \\
  \pause
  \vfill
  It is simply the continuous-time version of geometric growth, with
  instantaneous rate of change:
  \[
    \frac{dN}{dt} = rN
  \]
\end{frame}







%\section{Logistic growth}

\begin{frame}
  \frametitle{Logistic growth}
  Continuous-time version has instantaneous growth rate
  \[
    \frac{dN}{dt} = rN\left(1-\frac{N}{K}\right)
  \]
  \pause
  \vfill
  Discrete-time model (difference equation) looks like this:
  \[
    N_t = N_{t-1} + rN_{t-1}\left(1-\frac{N_{t-1}}{K}\right)
  \]
  \pause
  \vfill
  Discrete-time model can result in over-compensation and chaos
\end{frame}




\begin{frame}[fragile]
  \frametitle{What happens when we change $r$?}





\begin{center}
  \only<1|handout:0>{\includegraphics[width=\textwidth]{figure/Nl-1}}
  \only<2|handout:0>{\includegraphics[width=\textwidth]{figure/Nl2-1}}
  \only<3|handout:0>{\includegraphics[width=\textwidth]{figure/Nl3-1}}
  \only<4>{\includegraphics[width=\textwidth]{figure/Nl4-1}}
\end{center}
\end{frame}





\section{Matrix models}

\begin{frame}
  \frametitle{Age-structured population model}
%  \begin{itemize}
    % \item Age isn't always the best way to think about population structure
    % \item<2-> For some populations, it is much more useful to think about size
    %   structure or even spatial structure.
    % \item<3->  These ``stage-structured'' models differ from age-structured models
    %   in that individuals can remain in a stage class (with
    %   probability $1-p_i$) for multiple time periods.
    % \end{itemize}
  Age-structured model with 3 age classes.
  \vfill
  \tikzstyle{level 1} = [circle, draw, text width=0.5cm, minimum size=1.5cm,
  node distance=3cm, text centered, fill=blue!10]
  \pause
  \begin{center}
%   \uncover<2>{
   \begin{tikzpicture} \footnotesize %\small
      \node [level 1] (n1) [yshift=-5mm] {$n_{1,t}$};
      \node [level 1, right of=n1] (n2) [yshift=0mm] {$n_{2,t}$};
      \node [level 1, right of=n2] (n3) [yshift=0mm] {$n_{3,t}$};
      \draw[->,thick]  (n1) to node[above] {$s_1$} (n2);
      \draw[->,thick] (n2) to node[above] {$s_2$} (n3);
      \draw[->,thick] (n2) to [bend right=40] node[above] {$f_2$} (n1);
      \draw[->,thick] (n3) to [bend right=60] node[above] {$f_3$} (n1);
%      \draw[->,thick] (n2) to [loop below] node[below] {$(1-p_2)s_2$} (n2);
      \draw[->,thick] (n3) to [loop below] node[below] {$s_3$} (n3);
    \end{tikzpicture}
  \end{center}
% }
  \pause
  {Where $n_{i,t}$ is abundance of each age class $i$ at time $t$}
  \begin{itemize}[<+->]
    \item Depends on age class survival rates $s_{i}$
    \item And age class birth rates $b_{i}$
    \item Fecundity is often defined as the product of birth rate and offspring survival, $f_i = b_i
      \times s_0$
%    \item Note the lack of $t$ subscripts (for now)
  \end{itemize}
\end{frame}



\begin{frame}
  \frametitle{How does this population grow?}
  \Large
  \begin{center}
    \begin{tabular}{cl}
      \hline
      Age class & Equation \\
      \hline
      1 & $n_{1,t+1} = n_{1,t} \times f_1 + n_{2,t} \times f_2 + n_{3,t} \times f_3$ \\ \pause
      2 & $n_{2,t+1} = n_{1,t} \times s_{1}$ \\ \pause
      3 & $n_{3,t+1} = n_{2,t} \times s_{2} + n_{3,t} \times s_3$ \\
      \hline
    \end{tabular}
  \end{center}
\end{frame}






\begin{frame}
  \frametitle{Matrix models}
  \large
  These two expressions are equivalent: \par
  \vspace{0.5cm}
  \begin{tabular}{cl}
    \hline
    Age class & Equation \\
    \hline
    1 & $n_{1,t+1} = n_{1,t} \times f_{1} + n_{2,t} \times f_{2} + n_{3,t} \times f_3$ \\
    2 & $n_{2,t+1} = n_{1,t} \times s_{1}$ \\
    3 & $n_{3,t+1} = n_{2,t} \times s_{2} + n_{3,t} \times s_3$ \\
    \hline
  \end{tabular}
  \vfill
  {\centering AND \par}
  \vfill
  \[
    {\bf n}_{t+1} = {\bf A}\times {\bf n}_{t}
  \]
\end{frame}



\begin{frame}
  \frametitle{Matrix multiplication and Leslie matrix}
  \Large
  \begin{center}
    \[
    \begin{bmatrix}
      n_{1,t+1} \\
      n_{2,t+1} \\
      n_{3,t+1} 
    \end{bmatrix}
    =
    \begin{bmatrix}
      f_1 & f_2 & f_3 \\
      s_1 & 0 & 0 \\
      0 & s_2 & s_3 \\
    \end{bmatrix}
    \times
    \begin{bmatrix}
      n_{1,t} \\
      n_{2,t} \\
      n_{3,t} \\
    \end{bmatrix}
    \]
  \end{center}
\end{frame}







\begin{frame}[fragile]
  \frametitle{Population size, $n_{i,t}$}
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{T} \hlkwb{<-} \hlnum{30}                         \hlcom{## time steps}
\hlstd{n} \hlkwb{<-} \hlkwd{matrix}\hlstd{(}\hlnum{NA}\hlstd{,} \hlkwc{nrow}\hlstd{=}\hlnum{3}\hlstd{,} \hlkwc{ncol}\hlstd{=T)} \hlcom{## age-class abundance matrix    }
\hlstd{n[,}\hlnum{1}\hlstd{]} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{50}\hlstd{,} \hlnum{40}\hlstd{,} \hlnum{10}\hlstd{)}          \hlcom{## abundance at t=1}
\hlstd{s} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{0.4}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.3}\hlstd{)}           \hlcom{## survival rates}
\hlstd{f} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{0.8}\hlstd{,} \hlnum{1.7}\hlstd{)}             \hlcom{## fecundities}

\hlstd{A} \hlkwb{<-} \hlkwd{matrix}\hlstd{(}\hlkwd{c}\hlstd{(f, s[}\hlnum{1}\hlstd{],} \hlnum{0}\hlstd{,} \hlnum{0}\hlstd{,} \hlnum{0}\hlstd{, s[}\hlnum{2}\hlstd{], s[}\hlnum{3}\hlstd{]),}
            \hlkwc{nrow}\hlstd{=}\hlnum{3}\hlstd{,} \hlkwc{ncol}\hlstd{=}\hlnum{3}\hlstd{,} \hlkwc{byrow}\hlstd{=}\hlnum{TRUE}\hlstd{)}
\hlstd{A}                               \hlcom{## Leslie matrix}
\end{alltt}
\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]  0.0  0.8  1.7
## [2,]  0.4  0.0  0.0
## [3,]  0.0  0.5  0.3
\end{verbatim}
\begin{alltt}
\hlkwa{for}\hlstd{(t} \hlkwa{in} \hlnum{2}\hlopt{:}\hlstd{T) \{}
    \hlstd{n[,t]} \hlkwb{<-} \hlstd{A} \hlopt{%*%} \hlstd{n[,t}\hlopt{-}\hlnum{1}\hlstd{]}      \hlcom{## matrix multiplication}
\hlstd{\}}

\hlstd{lambda} \hlkwb{<-} \hlstd{n[,}\hlopt{-}\hlnum{1}\hlstd{]} \hlopt{/} \hlstd{n[,}\hlopt{-}\hlstd{T]}       \hlcom{## growth rates}
\end{alltt}
\end{kframe}
\end{knitrout}
\end{frame}





\begin{frame}[fragile]
  \frametitle{Population size, $n_{i,t}$}
\begin{knitrout}\scriptsize
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{matplot}\hlstd{(}\hlnum{1}\hlopt{:}\hlstd{T,} \hlkwd{t}\hlstd{(n),} \hlkwc{type}\hlstd{=}\hlstr{"o"}\hlstd{,} \hlkwc{pch}\hlstd{=}\hlnum{16}\hlstd{,} \hlkwc{xlab}\hlstd{=}\hlstr{"Time"}\hlstd{,} \hlkwc{ylab}\hlstd{=}\hlstr{"Population size"}\hlstd{,}
        \hlkwc{cex.lab}\hlstd{=}\hlnum{1.3}\hlstd{,} \hlkwc{ylim}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{60}\hlstd{),} \hlkwc{col}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"black"}\hlstd{,} \hlstr{"orange"}\hlstd{,} \hlstr{"purple"}\hlstd{))}
\hlkwd{legend}\hlstd{(}\hlnum{20}\hlstd{,} \hlnum{60}\hlstd{,} \hlkwd{c}\hlstd{(}\hlstr{"Age class 1"}\hlstd{,} \hlstr{"Age class 2"}\hlstd{,} \hlstr{"Age class 3"}\hlstd{),}
       \hlkwc{col}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"black"}\hlstd{,} \hlstr{"orange"}\hlstd{,} \hlstr{"purple"}\hlstd{),} \hlkwc{pch}\hlstd{=}\hlnum{16}\hlstd{,} \hlkwc{lty}\hlstd{=}\hlnum{1}\hlopt{:}\hlnum{3}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=0.99\textwidth]{figure/proj1-1} 

}



\end{knitrout}
% \vspace{0.9cm}
% \begin{center}
%   \includegraphics[width=0.85\textwidth]{figure/proj1-1}
% \end{center}
\end{frame}




\begin{frame}[fragile]
  \frametitle{Growth rates, $\lambda_{i,t} = n_{i,t+1}/n_{i,t}$}

\vspace{-0.9cm}
\begin{center}
  \includegraphics[width=0.99\textwidth]{figure/lambda1-1}
\end{center}
\end{frame}




\begin{frame}[fragile]
  \frametitle{Age distribution, $c_{i,t} = n_{i,t}/N_t$}

\vspace{-0.9cm}
\begin{center}
  \includegraphics[width=0.99\textwidth]{figure/prop1-1}
\end{center}
\end{frame}




\begin{frame}[fragile]
  \frametitle{In-class exercise}
  {\centering
  Add environmental stochasticity to the age-structured population
  model according to:
  \[
    {\bf n}_{t+1} = {\bf A}\times {\bf n}_{t} + {\bm \varepsilon}_t
  \]
  }
  where $\varepsilon_{i,t} \sim \mathrm{Norm}(0,0.5)$.
  \pause
  \vfill
  The key is to use \inr{rnorm} to draw 3 random numbers at each time 
  step, and then add these random values to:
\begin{knitrout}\footnotesize
\definecolor{shadecolor}{rgb}{0.878, 0.918, 0.933}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwa{for}\hlstd{(t} \hlkwa{in} \hlnum{2}\hlopt{:}\hlstd{T) \{}
    \hlstd{n[,t]} \hlkwb{<-} \hlstd{A} \hlopt{%*%} \hlstd{n[,t}\hlopt{-}\hlnum{1}\hlstd{]}
\hlstd{\}}
\end{alltt}
\end{kframe}
\end{knitrout}
  
\end{frame}




% \begin{frame}
%   \frametitle{Properties of simple age-structured models}
%   \large
%   Age distribution converges to a {\bf stable age
%     distribution} when survival and fecundity rates are constant. \\
%   \pause
%   \vfill
%   Stable age distribution is the proportion of individuals in each age
%   class when the population converges. \\
%   \pause
%   \vfill
%   Growth rates of each age class differ at first, but converge
%   once the stable age distribution is reached. \\
%   \pause
%   \vfill
%   Asymptotic growth rate is $\lambda$ (without subscript). \\
%   \pause
%   \vfill
%   Growth rate at the stable age distribution is the same for
%   all age classes, and it is geometric! \\
% \end{frame}







\begin{frame}
  \frametitle{Stage-structured population models}
  \begin{itemize}
    \item Age isn't always the best way to think about population structure
    \item<2-> For some populations, it is much more useful to think about size
      structure or even spatial structure.
    \item<3->  These ``stage-structured'' models differ from age-structured models
      in that individuals can remain in a stage class (with
      probability $1-p_i$) for multiple time periods.
  \end{itemize}
%  \vfill
  \tikzstyle{level 1} = [circle, draw, text width=0.5cm, minimum size=1.5cm,
  node distance=3cm, text centered, fill=blue!10]
  \begin{center}
   \uncover<4>{
   \begin{tikzpicture} \footnotesize %\small
      \node [level 1] (n1) [yshift=-5mm] {$n_{1,t}$};
      \node [level 1, right of=n1] (n2) [yshift=0mm] {$n_{2,t}$};
      \node [level 1, right of=n2] (n3) [yshift=0mm] {$n_{3,t}$};
      \draw[->,thick]  (n1) to node[above] {$s_1$} (n2);
      \draw[->,thick] (n2) to node[above] {$p_2s_2$} (n3);
      \draw[->,thick] (n2) to [bend right=40] node[above] {$f_2$} (n1);
      \draw[->,thick] (n3) to [bend right=60] node[above] {$f_3$} (n1);
      \draw[->,thick] (n2) to [loop below] node[below] {$(1-p_2)s_2$} (n2);
      \draw[->,thick] (n3) to [loop below] node[below] {$s_3$} (n3);
   \end{tikzpicture}
   }
  \end{center}
\end{frame}






%\begin{comment}
\begin{frame}
  \frametitle{Stage-structured population models}
  \large
  In stage-structured models, individuals transition from one
  stage to the next with probability $p_i$. \par
  \vfill
  \pause
  A simple example of a projection matrix like this:
  \pause
  \vfill
  \begin{center}
    \[
    {\bf A} =
    \begin{bmatrix}
      f_1 & f_2        & f_3 \\
      s_1 & s_2(1-p_2) & 0   \\
      0   & s_2 p_2    & s_3 \\
    \end{bmatrix}
    \]
  \end{center}
%\pause
%\vfill
%This example allows for individual to remain in stages 2 and 3 for
%more than one time period.
\end{frame}
%\end{comment}





%% Save these for the occupancy lecture
% \section{Metapopulation models}

% \begin{frame}
%   \frametitle{\large Abundance-based metapopulation population model}
%   Can be formulated as matrix model
% \end{frame}


% \begin{frame}
%   \frametitle{\large Occupancy-based metapopulation population model}

% \end{frame}



%\section{Stochasticity}








\begin{frame}
  \frametitle{Summary}
  Vital rates ($s$ and $f$) are usually age-specific. \\
  \pause
  \vfill
  Population growth will depend on age distribution. \\
  \pause
  \vfill
  If vital rates are constant, population will reach stable
  age distribution with constant growth rate $\lambda$. \\
  \pause
  \vfill
  Matrix models can be used to compute other quantities like
  \emph{reproductive value} that describe how each age class
  contributes to population growth. \\
  \pause
  \vfill
  But what about space and other forms of individual variation? And
  what about movement?
\end{frame}



    
    





\end{document}
